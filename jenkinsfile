pipeline {
    
    agent {
	    label 'agent1'
    }
    

    environment {
	    def btime="${BUILD_TIMESTAMP}"
		GIT_COMMIT_HASH = sh (script: "git log -n 1 --pretty=format:'%H'", returnStdout: true) 
	    SHORT_COMMIT = "${GIT_COMMIT_HASH[0..7]}"
        BRANCH = "${env.gitlabBranch}"
    }


    stages {
        // TODO add test
		stage('test'){
			steps {
				echo 'To be added someday. '
			}
		}
        
        stage('Build') {
            steps {
		sh 'docker build -t bm-app -f ./escape_room-Q-order/dockerfile ./escape_room-Q-order'            
            }
        }
    }
    
    
    post {
        always {
            // Clean up the workspace
            cleanWs()
               
           
        }
    }
}

